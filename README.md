A solution for this problem:
https://uva.onlinejudge.org/external/100/10047.pdf
